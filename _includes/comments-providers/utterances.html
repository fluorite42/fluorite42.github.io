<script>
  document.addEventListener('DOMContentLoaded', function () {
    const currentTheme = sessionStorage.getItem('theme');
    const commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    const script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', '{{ site.repository }}');
    script.setAttribute('issue-term', '{{ site.comments.utterances.issue_term | default: "pathname" }}');
    {% if site.comments.utterances.label %}
    script.setAttribute('label', '{{ site.comments.utterances.label }}');
    {% endif %}

    if (currentTheme === 'dark') {
      script.setAttribute('theme', '{{ site.comments.utterances.dark_theme | default: "github-dark" }}');
    } else {
      script.setAttribute('theme', '{{ site.comments.utterances.theme | default: "github-light" }}');
    }

    script.setAttribute('crossorigin', 'anonymous');
    commentContainer.appendChild(script);
  });
</script>
